<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="NCAR HPC Docs website"><meta name=author content="CISL CSG (Consulting Services Group)"><link href=https://NCAR.github.io/HPC-Docs/environment-and-software/user-environment/containers/running_containers/ rel=canonical><link rel=icon href="https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://arc.ucar.edu/knowledge_base/83853599"><meta name=generator content="mkdocs-1.5.3, mkdocs-material-8.5.10"><title>NCAR HPC Documentation</title><link rel=stylesheet href=../../../../assets/stylesheets/main.975780f9.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../css/timeago.css><link rel=stylesheet href=../../../../stylesheets/extra.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style><script src=../../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=cisl_default data-md-color-primary data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#general-considerations class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> <strong>This site is currently under ACTIVE DEVELOPMENT!</strong> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="NCAR HPC Documentation" class="md-header__button md-logo" aria-label="NCAR HPC Documentation" data-md-component=logo> <img src=../../../../assets/images/CISL-contemp-logo-blue-square.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> NCAR HPC Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Running Containers </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=cisl_default data-md-color-primary data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=cisl_default_dark data-md-color-primary data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/NCAR/HPC-Docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="NCAR HPC Documentation" class="md-nav__button md-logo" aria-label="NCAR HPC Documentation" data-md-component=logo> <img src=../../../../assets/images/CISL-contemp-logo-blue-square.png alt=logo> </a> NCAR HPC Documentation </label> <div class=md-nav__source> <a href=https://github.com/NCAR/HPC-Docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../getting-started/ >Getting Started</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting-started/user-responsibilities/ class=md-nav__link> User Responsibilities </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../../getting-started/accounts/ >Accounts</a> <label for=__nav_2_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Accounts data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Accounts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting-started/accounts/cit-passwords/ class=md-nav__link> CIT Passwords </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../../getting-started/accounts/duo/ >Duo Two-Factor Authentication</a> <label for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Duo Two-Factor Authentication" data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Duo Two-Factor Authentication </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting-started/accounts/duo/enrolling/ class=md-nav__link> Enrolling with Duo </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../getting-started/accounts/systems-accounting-manager/ class=md-nav__link> SAM </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../allocations/ >Allocations</a> <label for=__nav_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Allocations data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Allocations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting-started/managing-your-allocation/ class=md-nav__link> Managing Your Allocation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_3 type=checkbox id=__nav_2_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../../allocations/ncar-allocations/ >NCAR Allocations</a> <label for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="NCAR Allocations" data-md-level=3> <label class=md-nav__title for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> NCAR Allocations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../allocations/ncar-allocations/ncar-strategic-capability-nsc-projects/ class=md-nav__link> NCAR Strategic Capability (NSC) projects </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4 type=checkbox id=__nav_2_4_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../allocations/university-allocations/ >University Allocations</a> <label for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="University Allocations" data-md-level=3> <label class=md-nav__title for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> University Allocations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../allocations/university-allocations/university-large-allocation-request-preparation-instructions/ class=md-nav__link> University Large Allocation Request Preparation Instructions </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../allocations/determining-computational-resource-needs/ class=md-nav__link> Determining computational resource needs </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_6 type=checkbox id=__nav_2_4_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../../allocations/chap/ >CISL HPC Allocations Panel</a> <label for=__nav_2_4_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="CISL HPC Allocations Panel" data-md-level=3> <label class=md-nav__title for=__nav_2_4_6> <span class="md-nav__icon md-icon"></span> CISL HPC Allocations Panel </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../allocations/chap/chap-allocation-review-criteria/ class=md-nav__link> Allocation Review Criteria </a> </li> <li class=md-nav__item> <a href=../../../../allocations/chap/chap-conflict-of-interest-policy/ class=md-nav__link> Conflict of Interest Policy </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../getting-started/vpn-access/ class=md-nav__link> VPN access </a> </li> <li class=md-nav__item> <a href=../../../../getting-started/system-usage-policies/ class=md-nav__link> System Usage Policies </a> </li> <li class=md-nav__item> <a href=../../../../getting-started/data-retention-policies/ class=md-nav__link> Data Retention Policies </a> </li> <li class=md-nav__item> <a href=../../../../getting-started/best-practices-for-supercomputer-users/ class=md-nav__link> Best Practices for Supercomputer Users </a> </li> <li class=md-nav__item> <a href=../../../../getting-started/acknowledging-ncar-and-cisl/ class=md-nav__link> Acknowledging NCAR and CISL </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../../storage-systems/ >Storage Systems and Data Transfer</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Storage Systems and Data Transfer" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Storage Systems and Data Transfer </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../storage-systems/glade/ >GLADE (POSIX File Systems)</a> <label for=__nav_3_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="GLADE (POSIX File Systems)" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> GLADE (POSIX File Systems) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../storage-systems/glade/campaign/ class=md-nav__link> Campaign storage file system </a> </li> <li class=md-nav__item> <a href=../../../../storage-systems/glade/lustre/ class=md-nav__link> Lustre file systems </a> </li> <li class=md-nav__item> <a href=../../../../storage-systems/glade/setting-file-directory-permissions/ class=md-nav__link> Setting File and Directory Permissions </a> </li> <li class=md-nav__item> <a href=../../../../storage-systems/glade/using-access-control-lists/ class=md-nav__link> Using Access Control Lists </a> </li> <li class=md-nav__item> <a href=../../../../storage-systems/glade/recovering-files-from-snapshots/ class=md-nav__link> Recovering files from snapshots </a> </li> <li class=md-nav__item> <a href=../../../../storage-systems/glade/removing-large-number-of-files/ class=md-nav__link> Removing large number of files </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../../storage-systems/quasar/ >Quasar (Tape Storgae)</a> <label for=__nav_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Quasar (Tape Storgae)" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Quasar (Tape Storgae) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../storage-systems/quasar/quasar%2Bsystem%2Bspecifications/ class=md-nav__link> Quasar system specifications </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../storage-systems/stratus/ >Stratus (Object Storage)</a> <label for=__nav_3_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Stratus (Object Storage)" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Stratus (Object Storage) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../storage-systems/stratus/getting-started-with-an-object-storage-admin-account/ class=md-nav__link> Getting started with an object storage admin account </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../storage-systems/data-access-nodes/ class=md-nav__link> Data Access Nodes </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../../storage-systems/data-transfer/ >Transferring Data</a> <label for=__nav_3_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Transferring Data" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Transferring Data </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6_2 type=checkbox id=__nav_3_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../storage-systems/data-transfer/globus/ >Globus</a> <label for=__nav_3_6_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Globus data-md-level=3> <label class=md-nav__title for=__nav_3_6_2> <span class="md-nav__icon md-icon"></span> Globus </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../storage-systems/data-transfer/globus/Sharing%2Bdata%2Band%2Bmaking%2Bunattended%2Btransfers/ class=md-nav__link> Sharing data and making unattended transfers </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../storage-systems/data-transfer/scp-and-sftp/ class=md-nav__link> SCP, SFTP and other tools </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../storage-systems/cmip-analysis-platform/ class=md-nav__link> CMIP Analysis Platform </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../../ >User Environment and HPC Software</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="User Environment and HPC Software" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> User Environment and HPC Software </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../ >User Environment</a> <label for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="User Environment" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> User Environment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modules/ class=md-nav__link> Modules </a> </li> <li class=md-nav__item> <a href=../../conda/ class=md-nav__link> Conda </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_4 type=checkbox id=__nav_4_2_4 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Containers</a> <label for=__nav_4_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Containers data-md-level=3> <label class=md-nav__title for=__nav_4_2_4> <span class="md-nav__icon md-icon"></span> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../building_containers/ class=md-nav__link> Pulling, Building, and Sharing Containers </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Running Containers <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Running Containers </a> <nav class="md-nav md-nav--secondary" aria-label="Page Outline"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Page Outline </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#general-considerations class=md-nav__link> General considerations </a> <nav class=md-nav aria-label="General considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#interaction-with-environment-variables class=md-nav__link> Interaction with environment variables </a> </li> <li class=md-nav__item> <a href=#accessing-host-file-systems class=md-nav__link> Accessing host file systems </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#running-containerized-mpi-applications class=md-nav__link> Running containerized MPI applications </a> </li> <li class=md-nav__item> <a href=#running-containerized-gpu-applications class=md-nav__link> Running containerized GPU applications </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../examples/ class=md-nav__link> Example Workflows </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../utilities/ class=md-nav__link> Utilities </a> </li> <li class=md-nav__item> <a href=../../customizing/ class=md-nav__link> Customizing User Environment </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2_7 type=checkbox id=__nav_4_2_7> <div class="md-nav__link md-nav__link--index "> <a href=../../spack/ >Spack</a> <label for=__nav_4_2_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Spack data-md-level=3> <label class=md-nav__title for=__nav_4_2_7> <span class="md-nav__icon md-icon"></span> Spack </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../spack/spack-downstream/ class=md-nav__link> Spack Downstream </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../hpc-software/ >HPC Software</a> <label for=__nav_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="HPC Software" data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> HPC Software </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../community-models/ class=md-nav__link> Community Models </a> </li> <li class=md-nav__item> <a href=../../../data-analysis-and-visualization/ class=md-nav__link> Data Analysis and Visualization </a> </li> <li class=md-nav__item> <a href=../../../ncl/ class=md-nav__link> NCL </a> </li> <li class=md-nav__item> <a href=../../../matlab-parallel-computing-toolbox/ class=md-nav__link> MATLAB Parallel Computing Toolbox </a> </li> <li class=md-nav__item> <a href=../../../numerical-libraries/ class=md-nav__link> Numerical Libraries </a> </li> <li class=md-nav__item> <a href=../../../machine-learning-and-deep-learning/ class=md-nav__link> Machine Learning and Deep Learning </a> </li> <li class=md-nav__item> <a href=../../../ncar-classic-libraries-for-geophysics/ class=md-nav__link> NCAR Classic Libraries for Geophysics </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_9 type=checkbox id=__nav_4_3_9> <label class=md-nav__link for=__nav_4_3_9> Profiling & Debuggers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Profiling & Debuggers" data-md-level=3> <label class=md-nav__title for=__nav_4_3_9> <span class="md-nav__icon md-icon"></span> Profiling & Debuggers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../hpc-software/profiling-and-debuggers/running-ddt-map-and-pr-jobs/ class=md-nav__link> Debugging and Profiling with Forge Tools </a> </li> <li class=md-nav__item> <a href=../../../hpc-software/profiling-and-debuggers/intel-parallel-studio-xe/ class=md-nav__link> Intel Parallel Studio XE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_10 type=checkbox id=__nav_4_3_10> <div class="md-nav__link md-nav__link--index "> <a href=../../../benchmarks/ >Benchmarks</a> <label for=__nav_4_3_10> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Benchmarks data-md-level=3> <label class=md-nav__title for=__nav_4_3_10> <span class="md-nav__icon md-icon"></span> Benchmarks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../benchmarks/ncar-benchmarking-2015/ class=md-nav__link> NCAR Benchmarking applications - 2015 release </a> </li> <li class=md-nav__item> <a href=../../../benchmarks/ncar-benchmarking-2019-2020/ class=md-nav__link> NCAR Benchmarking applications - 2019-2020 release </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Compute Systems and Services <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Compute Systems and Services" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Compute Systems and Services </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_1 type=checkbox id=__nav_5_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../../compute-systems/derecho/ >Derecho</a> <label for=__nav_5_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Derecho data-md-level=2> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> Derecho </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../compute-systems/derecho/derecho-use-policies/ class=md-nav__link> Derecho Use Policies </a> </li> <li class=md-nav__item> <a href=../../../../compute-systems/derecho/compiling-code-on-derecho/ class=md-nav__link> Compiling Code on Derecho </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_1_4 type=checkbox id=__nav_5_1_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../compute-systems/derecho/starting-derecho-jobs/ >Starting Derecho Jobs</a> <label for=__nav_5_1_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Starting Derecho Jobs" data-md-level=3> <label class=md-nav__title for=__nav_5_1_4> <span class="md-nav__icon md-icon"></span> Starting Derecho Jobs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_1_4_2 type=checkbox id=__nav_5_1_4_2> <label class=md-nav__link for=__nav_5_1_4_2> Derecho Job Script Examples <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Derecho Job Script Examples" data-md-level=4> <label class=md-nav__title for=__nav_5_1_4_2> <span class="md-nav__icon md-icon"></span> Derecho Job Script Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../compute-systems/derecho/starting-derecho-jobs/derecho-job-script-examples/ class=md-nav__link> Derecho batch job script examples </a> </li> <li class=md-nav__item> <a href=../../../../compute-systems/derecho/starting-derecho-jobs/process-binding/ class=md-nav__link> Process Binding </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../compute-systems/derecho/derecho-modules/ class=md-nav__link> Derecho Software </a> </li> <li class=md-nav__item> <a href=../../../../compute-systems/derecho/moving-from-cheyenne/ class=md-nav__link> Moving to Derecho from Cheyenne </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 type=checkbox id=__nav_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../compute-systems/casper/ >Casper</a> <label for=__nav_5_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Casper data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Casper </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../compute-systems/casper/casper-use-policies/ class=md-nav__link> Casper Use Policies </a> </li> <li class=md-nav__item> <a href=../../../../compute-systems/casper/compiling-code-on-casper/ class=md-nav__link> Compiling Code on Casper </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2_4 type=checkbox id=__nav_5_2_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../../compute-systems/casper/starting-casper-jobs/ >Starting Casper Jobs</a> <label for=__nav_5_2_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Starting Casper Jobs" data-md-level=3> <label class=md-nav__title for=__nav_5_2_4> <span class="md-nav__icon md-icon"></span> Starting Casper Jobs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../compute-systems/casper/starting-casper-jobs/casper-job-script-examples/ class=md-nav__link> Casper job Script Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../compute-systems/casper/remote-desktops/ class=md-nav__link> Using Remote Desktops </a> </li> <li class=md-nav__item> <a href=../../../../compute-systems/casper/casper-modules/ class=md-nav__link> Casper Software </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_3 type=checkbox id=__nav_5_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../../compute-systems/jupyterhub/ >JupyterHub</a> <label for=__nav_5_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=JupyterHub data-md-level=2> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> JupyterHub </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../compute-systems/jupyter-and-ipython/ class=md-nav__link> Jupyter and IPython </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_4 type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4> Additional Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Resources" data-md-level=2> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Additional Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../compute-systems/additional-resources/thunder-test-system/ class=md-nav__link> Thunder test system </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../../pbs/ >Running Jobs (PBS)</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Running Jobs (PBS)" data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Running Jobs (PBS) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_2 type=checkbox id=__nav_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../pbs/job-scripts/ >Job Scripts</a> </div> <nav class=md-nav aria-label="Job Scripts" data-md-level=2> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Job Scripts </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../pbs/charging/ class=md-nav__link> Queues and Charging </a> </li> <li class=md-nav__item> <a href=../../../../pbs/preemption/ class=md-nav__link> Using Preemption </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_5 type=checkbox id=__nav_6_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../../pbs/common-causes-of-job-failures/ >Common Causes of Job Failures</a> <label for=__nav_6_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Common Causes of Job Failures" data-md-level=2> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> Common Causes of Job Failures </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_5_2 type=checkbox id=__nav_6_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../pbs/checking-memory-use/ >Checking Memory Use</a> </div> <nav class=md-nav aria-label="Checking Memory Use" data-md-level=3> <label class=md-nav__title for=__nav_6_5_2> <span class="md-nav__icon md-icon"></span> Checking Memory Use </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../pbs/storing-temporary-files/ class=md-nav__link> Storing temporary files </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <div class="md-nav__link md-nav__link--index "> <a href=../../../../tutorials/ >Tutorials</a> <label for=__nav_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Tutorials data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../tutorials/new-user-training/ class=md-nav__link> New User Training </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/dask-tutorial/ class=md-nav__link> Dask Tutorial </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/profiling-and-debugging/ class=md-nav__link> Profiling and Debugging </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/advanced-pbs/ class=md-nav__link> Advanced PBS </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/jupyterhub/ class=md-nav__link> JupyterHub </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/containers/ class=md-nav__link> Containers </a> </li> <li class=md-nav__item> <a href=../../../../tutorials/gpu-workshop/ class=md-nav__link> GPU Workshop </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <div class="md-nav__link md-nav__link--index "> <a href=../../../../user-support/ >User Support</a> <label for=__nav_8> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="User Support" data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> User Support </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_2 type=checkbox id=__nav_8_2> <label class=md-nav__link for=__nav_8_2> Troubleshooting Tips <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Troubleshooting Tips" data-md-level=2> <label class=md-nav__title for=__nav_8_2> <span class="md-nav__icon md-icon"></span> Troubleshooting Tips </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../user-support/troubleshooting-tips/killed-processes-on-login-nodes/ class=md-nav__link> Killed processes on login nodes </a> </li> <li class=md-nav__item> <a href=../../../../user-support/troubleshooting-tips/common-causes-of-job-failures/ class=md-nav__link> Common causes of job failures </a> </li> <li class=md-nav__item> <a href=../../../../user-support/troubleshooting-tips/batch-job-crashing/ class=md-nav__link> Batch jobs crashing </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <div class="md-nav__link md-nav__link--index "> <a href=../../../../nhug/ >NCAR User Group (NHUG)</a> <label for=__nav_9> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="NCAR User Group (NHUG)" data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> NCAR User Group (NHUG) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9_2 type=checkbox id=__nav_9_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../../nhug/archive/ >Archive of Past Meetings</a> </div> <nav class=md-nav aria-label="Archive of Past Meetings" data-md-level=2> <label class=md-nav__title for=__nav_9_2> <span class="md-nav__icon md-icon"></span> Archive of Past Meetings </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../nhug/upcoming-events/ class=md-nav__link> NHUG Upcoming Events </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../contributing/ class=md-nav__link> Contributing to the Documentation </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Page Outline"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Page Outline </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#general-considerations class=md-nav__link> General considerations </a> <nav class=md-nav aria-label="General considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#interaction-with-environment-variables class=md-nav__link> Interaction with environment variables </a> </li> <li class=md-nav__item> <a href=#accessing-host-file-systems class=md-nav__link> Accessing host file systems </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#running-containerized-mpi-applications class=md-nav__link> Running containerized MPI applications </a> </li> <li class=md-nav__item> <a href=#running-containerized-gpu-applications class=md-nav__link> Running containerized GPU applications </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/NCAR/HPC-Docs/edit/main/docs/environment-and-software/user-environment/containers/running_containers.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1>Running Containers</h1> <h2 id=general-considerations>General considerations<a class=headerlink href=#general-considerations title="Permanent link">&para;</a></h2> <h3 id=interaction-with-environment-variables>Interaction with environment variables<a class=headerlink href=#interaction-with-environment-variables title="Permanent link">&para;</a></h3> <p>Different container run-times differ greatly in how they handle environment variables set <em>externally</em> on the host. Docker (and by similarity Podman) usually runs containers in a "clean" environment, that is, variables set on the host do not exist inside the container. Charliecloud by contrast passes nearly all environment variables from the host into the container. Apptainer takes a middle ground, by default passing along host environment variables, but this behavior can be changed with command-line arguments.</p> <p>The Docker/Podman approach makes sense when containerizing small services or pieces of code that you want to run identically everywhere, independent of the host environment. Conversely, the Apptainer &amp; Charliecloud approach makes more sense when many useful variables are already defined in the environment. Regardless, at some point when working with containers you will undoubtedly find an issue that is traced either to a variable being inherited from the host when you don't want it to be, or missing in the container when you really want it.</p> <p>Each run-time allows for environment variables to be set explicitly from the run command line. Additionally, when building containers you can generally embed environment variables as well. Again, this behavior is run-time dependent as shown in the following example.</p> <div class="admonition example"> <p class=admonition-title>Container run-times and environment variables</p> <p><strong>Host Environment</strong></p> <p>We set the following variables on the host system prior to launching the container: <div class=highlight><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nb>export</span><span class=w> </span><span class=nv>HOST_VAR</span><span class=o>=</span><span class=s2>&quot;foo&quot;</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nb>export</span><span class=w> </span><span class=nv>TOGGLE_VAR</span><span class=o>=</span><span class=s2>&quot;set_from_OUTSIDE&quot;</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=nb>unset</span><span class=w> </span>RANDOM_VAR
</span></code></pre></div></p> <p><strong>Container Environment</strong></p> <p>We then construct a tiny container image (&lt;10MB) from the minimal <a href=https://www.alpinelinux.org/ >Alpine Linux</a> distribution. When we run the container it will report the value of several environment variables: <code>HOST_VAR</code>, <code>CONTAINER_VAR</code>, <code>TOGGLE_VAR</code>, and <code>RANDOM_VAR</code> (if set).</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:3><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Apptainer</label><label for=__tabbed_1_2>Charliecloud</label><label for=__tabbed_1_3>Podman</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>The Apptainer Definition file <code>%environment</code> section allows us to define variables that exist <em>inside</em> the container. <div class=highlight><span class=filename>Definition File</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Bootstrap: docker
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>From: docker.io/alpine:latest
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>%files
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>   ./extras/speak.sh /opt/container/speak.sh
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>   ./extras/list_glade_filesystems.sh /opt/container/list_glade_filesystems.sh
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>%post
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>   chmod +x /opt/container/*.sh
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>%environment
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    export CONTAINER_VAR=&quot;bar&quot;
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    export TOGGLE_VAR=&quot;set_from_INSIDE&quot;
</span></code></pre></div> <strong>Container Environment Examples</strong></p> <p>Running the container shows that <code>HOST_VAR</code> is passed in by default, and <code>TOGGLE_VAR</code> retains its value from inside the container definition unless explicitly passed via the <code>--env</code> argument. The argument <code>--cleanenv</code> prevents external variables from being passed. <div class=highlight><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#1:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=go>host$ singularity run ./my_alpine.sif /opt/container/speak.sh</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=go>------------------------------</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=go>HOST_VAR=foo</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=go>TOGGLE_VAR=set_from_INSIDE</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>------------------------------</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#2:</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>host$ singularity run --cleanenv ./my_alpine.sif /opt/container/speak.sh</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>------------------------------</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>HOST_VAR=</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=go>TOGGLE_VAR=set_from_INSIDE</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=go>------------------------------</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#3:</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=go>host$ singularity run --cleanenv --env TOGGLE_VAR=set_from_OUTSIDE ./my_alpine.sif /opt/container/speak.sh</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=go>------------------------------</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=go>HOST_VAR=</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=go>TOGGLE_VAR=set_from_OUTSIDE</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=go>------------------------------</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#4:</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=go>host$ singularity run --cleanenv --env RANDOM_VAR=set_on_command-line ./my_alpine.sif /opt/container/speak.sh</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=go>------------------------------</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=go>HOST_VAR=</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=go>TOGGLE_VAR=set_from_INSIDE</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=go>RANDOM_VAR=set_on_command-line</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=go>------------------------------</span>
</span></code></pre></div></p> </div> <div class=tabbed-block> <p>The Charliecloud <code>Dockerfile</code> <code>ENV</code> section allows us to define variables, but its use seems inconsistent in practice. <div class=highlight><span class=filename>Dockerfile</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>FROM alpine:latest
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>COPY extras/speak.sh /opt/container/speak.sh
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>COPY extras/list_glade_filesystems.sh /opt/container/list_glade_filesystems.sh
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>RUN chmod +x /opt/container/*.sh \
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    &amp;&amp; mkdir -p /glade/u/home /glade/work /glade/campaign /glade/derecho/scratch /random/path
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>ENV CONTAINER_VAR=&quot;bar&quot; \
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>    TOGGLE_VAR=&quot;set_from_INSIDE&quot;
</span></code></pre></div> <strong>Container Environment Examples</strong></p> <p>Running the container shows that <code>HOST_VAR</code> is passed in by default, and <code>TOGGLE_VAR</code> always takes its value from the host. The argument <code>--set-env=VAR=val</code> allows variables to be passed to the container. Despite being set with the <code>ENV</code> instruction, <code>CONTAINER_VAR</code> has disappeared. The argument <code>--unset-env</code> can be passed to prevent certain specified host variables from passing into the container, with <code>--unset-env="*"</code> preventing any. <div class=highlight><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#1:</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=go>host$ ch-run ./my_alpine.sqfs -- /opt/container/speak.sh</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go>------------------------------</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=go>HOST_VAR=foo</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go>CONTAINER_VAR=</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=go>TOGGLE_VAR=set_from_OUTSIDE</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=go>------------------------------</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#2:</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=go>host$ ch-run &#39;--unset-env=*&#39; ./my_alpine.sqfs -- /opt/container/speak.sh</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=go>------------------------------</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=go>HOST_VAR=</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=go>CONTAINER_VAR=</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=go>TOGGLE_VAR=</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=go>------------------------------</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#3:</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=go>host$ ch-run --set-env=TOGGLE_VAR=set_from_OUTSIDE ./my_alpine.sqfs -- /opt/container/speak.sh</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=go>------------------------------</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=go>HOST_VAR=foo</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=go>CONTAINER_VAR=</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=go>TOGGLE_VAR=set_from_OUTSIDE</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=go>------------------------------</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#4:</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=go>host$ ch-run --set-env=RANDOM_VAR=set_on_command-line ./my_alpine.sqfs -- /opt/container/speak.sh</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=go>------------------------------</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=go>HOST_VAR=foo</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=go>CONTAINER_VAR=</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=go>TOGGLE_VAR=set_from_OUTSIDE</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=go>RANDOM_VAR=set_on_command-line</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=go>------------------------------</span>
</span></code></pre></div> <strong>Discussion</strong></p> <p>Apparently, Charliecloud honors the <code>ENV</code> <code>Dockerfile</code> instruction at build-time but disregards it at run-time.</p> </div> <div class=tabbed-block> <p>The Podman <code>Dockerfile</code> <code>ENV</code> section allows us to define variables that exist <em>inside</em> the container. <div class=highlight><span class=filename>Dockerfile</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>FROM docker.io/alpine:latest
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>COPY extras/speak.sh /opt/container/speak.sh
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>COPY extras/list_glade_filesystems.sh /opt/container/list_glade_filesystems.sh
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>RUN chmod +x /opt/container/*.sh
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>ENV CONTAINER_VAR=&quot;bar&quot; \
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>    TOGGLE_VAR=&quot;set_from_INSIDE&quot;
</span></code></pre></div> <strong>Container Environment Examples</strong></p> <p>Running the container shows that <code>HOST_VAR</code> is not passed in by default, and <code>TOGGLE_VAR</code> retains its value from inside the container definition unless explicitly passed via the <code>--env</code> argument. <div class=highlight><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#1:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=go>host$ podman run my_alpine:latest /opt/container/speak.sh</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=go>------------------------------</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=go>HOST_VAR=</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=go>TOGGLE_VAR=set_from_INSIDE</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=go>------------------------------</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#2:</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=go>host$ podman run --env TOGGLE_VAR=set_from_OUTSIDE my_alpine:latest /opt/container/speak.sh</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=go>------------------------------</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=go>HOST_VAR=</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=go>TOGGLE_VAR=set_from_OUTSIDE</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=go>------------------------------</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#3:</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=go>host$ podman run --env RANDOM_VAR=set_on_command-line my_alpine:latest /opt/container/speak.sh</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=go>------------------------------</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=go>HOST_VAR=</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=go>CONTAINER_VAR=bar</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=go>TOGGLE_VAR=set_from_INSIDE</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=go>RANDOM_VAR=set_on_command-line</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=go>------------------------------</span>
</span></code></pre></div></p> </div> </div> </div> <hr> <p><strong>Summary</strong></p> <p>Each container run-time allows you to pass environment variables in via command line arguments, and have different default behaviors with respect to host-defined variables. Some allow you to set default values that exist inside the container. Our best guidance is simply be aware of what is defined in your execution environment, pass critical values via command line arguments to avoid ambiguity, and perform error checking on environment variable values inside your image to be safe.</p> <hr> <p>Full definitions of the test cases can be found <a href=https://github.com/NCAR/hpc-demos/tree/main/containers/tutorial>here</a>.</p> </div> <h3 id=accessing-host-file-systems>Accessing host file systems<a class=headerlink href=#accessing-host-file-systems title="Permanent link">&para;</a></h3> <p>Similar to treatment of environment variables, each container run-time has unique behavior with respect to home and initial working directories inside containers. By default all provide minimal access to the host file systems, however they allow for host directories to be "bind mounted" into the container upon request. Following the same approach outlined above, we use our minimal container image to illustrate default and optional file system accessibility.</p> <div class="admonition example"> <p class=admonition-title>Container run-times and mounting host file systems</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Apptainer</label><label for=__tabbed_2_2>Charliecloud</label><label for=__tabbed_2_3>Podman</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>The <code>singularity</code> <code>--bind</code> option allows host directories to be bind-mounted into the container.</p> <p>As shown below, by default the users' home directory is mounted. The initial working directory (<code>PWD</code>) behavior depends on where the container is launched from, and if that path has been bind-mounted into the container or not (Steps 1 &amp; 3). The initial directory can be set explicitly with the <code>--pwd</code> flag (Step 2). <div class=highlight><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#1:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=go>host$ singularity run ./my_alpine.sif /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=go>------------------------------</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=go>HOME=/glade/u/home/benkirk</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=go>PWD=/glade/u/home/benkirk</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=go>glade_user              150.0T     77.7T     72.3T  52% /glade/u/home/benkirk</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=go>------------------------------</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#2:</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=go>host$ singularity run --pwd /opt/container ./my_alpine.sif /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=go>------------------------------</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=go>HOME=/glade/u/home/benkirk</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=go>PWD=/opt/container</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=go>glade_user              150.0T     77.7T     72.3T  52% /glade/u/home/benkirk</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=go>------------------------------</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#3:</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=go>host$ singularity run --bind /glade/u/home/benkirk --bind /glade/derecho/scratch --bind /glade/work --bind /glade/campaign --bind /glade/work:/random/path ./my_alpine.sif /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=go>------------------------------</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=go>HOME=/glade/u/home/benkirk</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=go>PWD=/glade/work/benkirk/repos/csg-utils/hpc-demos/containers/tutorial/apptainer</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=go>glade_user              150.0T     77.7T     72.3T  52% /glade/u/home/benkirk</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=go>glade_user              150.0T     77.7T     72.3T  52% /glade/u/home/benkirk</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=go>                         54.5P     10.7P     43.3P  20% /glade/derecho/scratch</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=go>csfs1                     4.0P    983.2T      3.0P  24% /glade/work</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=go>csfs1                   120.7P     93.5P     27.2P  77% /glade/campaign</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=go>csfs1                     4.0P    983.2T      3.0P  24% /random/path</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=go>------------------------------</span>
</span></code></pre></div></p> </div> <div class=tabbed-block> <p>The <code>ch-run</code> <code>--bind</code> option allows host directories to be bind-mounted into the container. Note that Charliecloud will not create new directories for the bind-mount locations, so we need to ensure they are created within our <code>Dockerfile</code>: <div class=highlight><span class=filename>Dockerfile</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>FROM alpine:latest
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>COPY extras/speak.sh /opt/container/speak.sh
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>COPY extras/list_glade_filesystems.sh /opt/container/list_glade_filesystems.sh
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>RUN chmod +x /opt/container/*.sh \
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    &amp;&amp; mkdir -p /glade/u/home /glade/work /glade/campaign /glade/derecho/scratch /random/path
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>ENV CONTAINER_VAR=&quot;bar&quot; \
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    TOGGLE_VAR=&quot;set_from_INSIDE&quot;
</span></code></pre></div> As shown below, by default the users' home directory is mounted. The initial working directory (<code>PWD</code>) is the container file system root (<code>/</code>). In Step 2 we bind some of the common GLADE file systems into the container using the directories created in the <code>Dockerfile</code>. Step 3 fails, showing Charliecloud refusing to bind-mount into <code>/random/other</code> since no such mount point exists in the base image. <div class=highlight><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#1:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=go>host$ ch-run ./my_alpine.sqfs -- /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=go>------------------------------</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=go>HOME=/glade/u/home/benkirk</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=go>PWD=/</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=go>------------------------------</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#2:</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=go>host$ ch-run --bind=/glade/derecho/scratch --bind=/glade/work --bind=/glade/campaign --bind=/glade/work:/random/path ./my_alpine.sqfs -- /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=go>------------------------------</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=go>HOME=/glade/u/home/benkirk</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=go>PWD=/</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=go>                         54.5P     10.7P     43.3P  20% /glade/derecho/scratch</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=go>csfs1                     4.0P    983.1T      3.0P  24% /glade/work</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=go>csfs1                   120.7P     93.5P     27.2P  77% /glade/campaign</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=go>csfs1                     4.0P    983.1T      3.0P  24% /random/path</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=go>------------------------------</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#3:</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=go>host$ ch-run --bind=/glade/derecho/scratch --bind=/glade/work --bind=/glade/campaign --bind=/glade/work:/random/other/path ./my_alpine.sqfs -- /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=go>ch-run[73181]: error: can&#39;t mkdir: /var/tmp/benkirk.ch/mnt/random/other: Read-only file system (ch_misc.c:409 30)</span>
</span></code></pre></div> <strong>Discussion</strong></p> <p>Charliecloud will not create destination paths for bind-mounts inside the container. Make sure you create such mount points when you build the image.</p> </div> <div class=tabbed-block> <p>The Podman <code>--volume</code> option allows host directories to be bind-mounted into the container.</p> <p>As shown below, by default the users' is placed into <code>/root</code> as a home directory, The initial working directory (<code>PWD</code>) is the container file system root (<code>/</code>). <div class=highlight><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#1:</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=go>host$ podman run my_alpine:latest /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=go>------------------------------</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=go>HOME=/root</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=go>PWD=/</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=go>------------------------------</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=gp># </span>Step<span class=w> </span><span class=c1>#2:</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=go>host$ podman run --volume /glade/u/home/benkirk --volume /glade/derecho/scratch --volume /glade/work --volume /glade/campaign --volume /glade/work:/random/path my_alpine:latest /opt/container/list_glade_filesystems.sh</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=go>------------------------------</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=go>HOME=/root</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=go>PWD=/</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=go>mergedroot              188.3G      2.0G    186.3G   1% /glade/work</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=go>csfs1                     4.0P    983.1T      3.0P  24% /random/path</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=go>mergedroot              188.3G      2.0G    186.3G   1% /glade/campaign</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=go>mergedroot              188.3G      2.0G    186.3G   1% /glade/derecho/scratch</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=go>mergedroot              188.3G      2.0G    186.3G   1% /glade/u/home/benkirk</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=go>------------------------------</span>
</span></code></pre></div></p> </div> </div> </div> <hr> <p><strong>Summary</strong></p> <p>Each run-time has a method for accessing host directories within the container. They are all different with how they treat the users' home and initial working directory inside the container. Do not assume a given behavior, rather be explicit with changing directories and specifying full paths as necessary.</p> <hr> <p>Full definitions of the test cases can be found <a href=https://github.com/NCAR/hpc-demos/tree/main/containers/tutorial>here</a>.</p> </div> <hr> <h2 id=running-containerized-mpi-applications>Running containerized MPI applications<a class=headerlink href=#running-containerized-mpi-applications title="Permanent link">&para;</a></h2> <p>The interaction between MPI implementations and container run-times is unfortunately the single biggest pain point of running containers in the HPC environment. If you're drawn to the "simplicity" promised by containerization but need to run on multiple nodes with MPI, we strongly encourage you to fully consider this section before going further. (The issues are well described <a href=https://apptainer.org/docs/user/latest/mpi.html>here</a>.) First let us distinguish two use cases:</p> <ol> <li> <p><strong>Running MPI <em>inside</em> a container on a single node, using an MPI stack defined within the container</strong>: While somewhat limited, this case is fairly easy to handle since the complexities of interfacing with a high-speed network are largely eliminated.</p> </li> <li> <p><strong>Running MPI <em>across</em> multiple nodes, launching the run-time with MPI from the host</strong>: This is the general case, and also where complications arise. This is the focus of the remainder of this section.</p> </li> </ol> <p>When using MPI on the host to launch an MPI application that was compiled within the container, it is imperative the <em>host</em> and <em>container</em> MPI implementations be compatible. In practice this means the pair should be from the same implementation (e.g. OpenMPI, or MPICH) and at similar versions - and the closer the versions the better. This means the container image can rarely be created without knowledge of the execution host environment.</p> <p>For Casper, where we deploy OpenMPI by default, this is not too terribly complicated since most containerized operating systems can easily install similar versions. For Derecho, however, the default MPI is Cray's MPICH, which is proprietary and therefore difficult in general to install into an arbitrary container image. In this case we must choose particular versions of MPI for the container image, knowing in advance they share heritage with the target host system. This allows us to build MPI applications inside the container with a compatible - but readily available - MPI.</p> <p>We then follow the <a href=https://apptainer.org/docs/user/latest/mpi.html#id1>"bind model"</a> approach when running the container in order to "replace" the container MPI with the host MPI, gaining access to the high-speed network and vendor MPI optimizations. For a full demonstration of this process, see <a href=../examples/#building-and-running-containerized-fasteddy-under-mpi-on-gpus>our containerized FastEddy example</a>.</p> <hr> <h2 id=running-containerized-gpu-applications>Running containerized GPU applications<a class=headerlink href=#running-containerized-gpu-applications title="Permanent link">&para;</a></h2> <p>Many GPU compute capabilities are directly available within containers to applications. CUDA, OpenMP and OpenACC offload codes will generally work without any special consideration.</p> <p>An exception is interfacing directly with the kernel driver. If you require such functionality, Apptainer provides the easiest support path through its <code>--nv</code> command line argument. See the <a href=https://apptainer.org/docs/user/latest/gpu.html>Apptainer GPU documentation page</a> for more details. <div class=highlight><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a># running nvidia-smi from within the container, try 1:
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>casper$ singularity exec --cleanenv ./my_cuda_container.sif nvidia-smi
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>Failed to initialize NVML: Driver/library version mismatch
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a># running nvidia-smi from within the container, try 2:
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>casper$ singularity exec --nv --cleanenv ./my_cuda_container.sif nvidia-smi
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>|-----------------------------------------+----------------------+----------------------+
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>|                                         |                      |               MIG M. |
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>|=========================================+======================+======================|
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>|   0  Tesla V100-SXM2-32GB           On  | 00000000:89:00.0 Off |                    0 |
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>| N/A   30C    P0              39W / 300W |      0MiB / 32768MiB |      0%      Default |
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>|                                         |                      |                  N/A |
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>+-----------------------------------------+----------------------+----------------------+
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>[...]
</span></code></pre></div></p> <!--  LocalWords:  Podman Charliecloud Apptainer Dockerfile MPI MPICH OpenMPI FastEddy
 --> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-12-11T18:24:42+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-12-11</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-12-11T18:24:42+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-12-11</span> </small> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label> <a href=../building_containers/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Pulling, Building, and Sharing Containers" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Pulling, Building, and Sharing Containers </div> </div> </a> <a href=../examples/ class="md-footer__link md-footer__link--next" aria-label="Next: Example Workflows" rel=next> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Example Workflows </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2023 UCAR, Licensed under the <a href=https://creativecommons.org/licenses/by-sa/4.0/ >Creative Commons CC-BY-SA 4.0</a>. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://arc.ucar.edu/ target=_blank rel=noopener title=arc.ucar.edu class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.07 4.93C17.22 3 14.66 1.96 12 2c-2.66-.04-5.21 1-7.06 2.93C3 6.78 1.96 9.34 2 12c-.04 2.66 1 5.21 2.93 7.06C6.78 21 9.34 22.04 12 22c2.66.04 5.21-1 7.06-2.93C21 17.22 22.04 14.66 22 12c.04-2.66-1-5.22-2.93-7.07M17 12v6h-3.5v-5h-3v5H7v-6H5l7-7 7.5 7H17Z"/></svg> </a> <a href=https://ithelp.ucar.edu/plugins/servlet/desk/site/rc target=_blank rel=noopener title=ithelp.ucar.edu class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m15.07 11.25-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8a4 4 0 0 1 4-4 4 4 0 0 1 4 4 3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10Z"/></svg> </a> <a href=https://github.com/NCAR target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://join.slack.com/t/ncarhpcusergroup/shared_invite/zt-1z00napom-SU0X8CzJWVY90C2GzRvUCg target=_blank rel=noopener title=join.slack.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg> </a> </div> </div> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <table class=md-footer-meta__inner> <colgroup> <col style="width: 10%"> <col style="width: 90%"> </colgroup> <tbody> <tr> <td valign=center> <img alt="National Science Foundation" src=https://www.nsf.gov/news/mmg/media/images/bitmaplogo_nolayers_f_e50fcd0b-607b-4271-a808-914d9c2f65dc.png height=140 width=180> </td> <td valign=center> <p style="font-size:0.75em; "> This material is based upon work supported by the National Center for Atmospheric Research, a major facility sponsored by National Science Foundation and managed by the University Corporation for Atmospheric Research. Any opinions, findings and conclusions or recommendations expressed in this material do not necessarily reflect the views of the National Science Foundation. </p> </td> </tr> </tbody> </table> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.annotate", "content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "navigation.indexes", "navigation.top", "navigation.path", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.5a2dcb6a.min.js></script> <script src=../../../../js/timeago.min.js></script> <script src=../../../../js/timeago_mkdocs_material.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> <script src=../../../../js/open_in_new_tab.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>